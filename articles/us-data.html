<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>U.S. Case and Mortality Data • covdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="U.S. Case and Mortality Data">
<meta property="og:description" content="covdata">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">covdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/covdata.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/codebook.html">Summary Codebook</a>
    </li>
    <li>
      <a href="../articles/ecdc-data.html">European Centers for Disease Control Data</a>
    </li>
    <li>
      <a href="../articles/excess-mortality.html">Excess Mortality Data</a>
    </li>
    <li>
      <a href="../articles/us-data.html">U.S. Case and Mortality Data</a>
    </li>
    <li>
      <a href="../articles/mobility-data.html">Mobility Data from Apple and Google</a>
    </li>
    <li>
      <a href="../articles/new-york-times.html">New York Times Data</a>
    </li>
    <li>
      <a href="../articles/coronanet-data.html">CoronaNet Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kjhealy/covdata">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="us-data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>U.S. Case and Mortality Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kjhealy/covdata/blob/master/vignettes/us-data.Rmd"><code>vignettes/us-data.Rmd</code></a></small>
      <div class="hidden name"><code>us-data.Rmd</code></div>

    </div>

    
    
<div id="load-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-the-data" class="anchor"></a>Load the Data</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span>)
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.2     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.0.3     ✔ dplyr   1.0.0</span>
<span class="co">#&gt; ✔ tidyr   1.1.0     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.5.0</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/kjhealy/covdata">covdata</a></span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'covdata'</span>
<span class="co">#&gt; The following object is masked from 'package:datasets':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     uspop</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://github.com/slowkow/ggrepel">ggrepel</a></span>)
</pre></div>
<p>Data for the United States come from a variety of sources:</p>
<ul>
<li>State-level case and mortality data for the United States from the <a href="https://covidtracking.com">COVID Tracking Project</a>.</li>
<li>State-level and county-level case and mortality data for the United States from the <a href="https://github.com/nytimes/covid-19-data"><em>New York Times</em></a>.</li>
<li>Data from the US Centers for Disease Control’s <a href="https://gis.cdc.gov/grasp/covidnet/COVID19_3.html">Coronavirus Disease 2019 (COVID-19)-Associated Hospitalization Surveillance</a>.</li>
<li>State- and national-level reports from the United States <a href="https://www.cdc.gov/nchs/">National Center for Health Statistics</a>.</li>
</ul>
</div>
<div id="covid-tracking-project-data" class="section level2">
<h2 class="hasAnchor">
<a href="#covid-tracking-project-data" class="anchor"></a>COVID Tracking Project data</h2>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">covus</span>
<span class="co">#&gt; # A tibble: 129,761 x 7</span>
<span class="co">#&gt;    date       state fips  data_quality_gra… measure       count measure_label   </span>
<span class="co">#&gt;    &lt;date&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;           </span>
<span class="co">#&gt;  1 2020-07-19 AK    02    A                 positive       2277 Positive Tests  </span>
<span class="co">#&gt;  2 2020-07-19 AK    02    A                 negative     170733 Negative Tests  </span>
<span class="co">#&gt;  3 2020-07-19 AK    02    A                 pending          NA Pending Tests   </span>
<span class="co">#&gt;  4 2020-07-19 AK    02    A                 hospitalize…     27 Currently Hospi…</span>
<span class="co">#&gt;  5 2020-07-19 AK    02    A                 hospitalize…     NA Cumulative Hosp…</span>
<span class="co">#&gt;  6 2020-07-19 AK    02    A                 in_icu_curr…     NA Currently in ICU</span>
<span class="co">#&gt;  7 2020-07-19 AK    02    A                 in_icu_cumu…     NA Cumulative in I…</span>
<span class="co">#&gt;  8 2020-07-19 AK    02    A                 on_ventilat…      1 Currently on Ve…</span>
<span class="co">#&gt;  9 2020-07-19 AK    02    A                 on_ventilat…     NA Cumulative on V…</span>
<span class="co">#&gt; 10 2020-07-19 AK    02    A                 recovered       712 Recovered       </span>
<span class="co">#&gt; # … with 129,751 more rows</span>
</pre></div>
<div id="draw-a-log-linear-graph-of-cumulative-reported-us-cases-" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-a-log-linear-graph-of-cumulative-reported-us-cases-" class="anchor"></a>Draw a log-linear graph of cumulative reported US cases.</h3>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co">## Which n states are leading the count of positive cases or deaths?</span>
<span class="kw">top_n_states</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">data</span>, <span class="kw">n</span> = <span class="fl">5</span>, <span class="kw">measure</span> = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"positive"</span>, <span class="st">"death"</span>)) {
  <span class="kw">meas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html">match.arg</a></span>(<span class="kw">measure</span>)
  <span class="kw">data</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">state</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">measure</span> <span class="op">==</span> <span class="kw">meas</span>, <span class="kw">date</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">date</span>)) <span class="op">%&gt;%</span>
  <span class="fu">drop_na</span>() <span class="op">%&gt;%</span>
  <span class="fu">ungroup</span>() <span class="op">%&gt;%</span>
  <span class="fu">top_n</span>(<span class="kw">n</span>, wt = <span class="kw">count</span>) <span class="op">%&gt;%</span>
  <span class="fu">pull</span>(<span class="kw">state</span>)
}

<span class="kw">state_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gray70"</span>, <span class="st">"#195F90FF"</span>, <span class="st">"#D76500FF"</span>, <span class="st">"#238023FF"</span>, <span class="st">"#AB1F20FF"</span>, <span class="st">"#7747A3FF"</span>, 
                <span class="st">"#70453CFF"</span>, <span class="st">"#D73EA8FF"</span>, <span class="st">"#666666FF"</span>, <span class="st">"#96971BFF"</span>, <span class="st">"#1298A6FF"</span>, <span class="st">"#6F9BD6FF"</span>, 
                <span class="st">"#FF952DFF"</span>, <span class="st">"#66CF51FF"</span>, <span class="st">"#FF4945FF"</span>, <span class="st">"#A07DBAFF"</span>, <span class="st">"#AC7368FF"</span>, <span class="st">"#EF69A2FF"</span>, 
                <span class="st">"#9F9F9FFF"</span>, <span class="st">"#CACA56FF"</span>, <span class="st">"#61C3D5FF"</span>)

<span class="kw">covus</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">state</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(core = <span class="fu">case_when</span>(<span class="kw">state</span> <span class="op">%nin%</span> <span class="fu">top_n_states</span>(<span class="kw">covus</span>) <span class="op">~</span> <span class="st">""</span>,
                          <span class="fl">TRUE</span> <span class="op">~</span> <span class="kw">state</span>),
         end_label = <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw">date</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">date</span>), <span class="kw">core</span>, <span class="fl">NA</span>)) <span class="op">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="kw">date</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">measure</span> <span class="op">==</span> <span class="st">"positive"</span>, <span class="kw">date</span> <span class="op">&gt;</span> <span class="st">"2020-03-09"</span>) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x = <span class="kw">date</span>, y = <span class="kw">count</span>, group = <span class="kw">state</span>, color = <span class="kw">core</span>, label = <span class="kw">end_label</span>)) <span class="op">+</span> 
  <span class="fu">geom_line</span>(size = <span class="fl">0.5</span>) <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span>(segment.color = <span class="fl">NA</span>, nudge_x = <span class="fl">0.2</span>, nudge_y = <span class="fl">0.1</span>) <span class="op">+</span> 
  <span class="fu">scale_color_manual</span>(values = <span class="kw">state_cols</span>) <span class="op">+</span> 
  <span class="fu">scale_x_date</span>(date_breaks = <span class="st">"1 week"</span>, date_labels = <span class="st">"%b %e"</span> ) <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span>(trans = <span class="st">"log2"</span>,
                     labels = <span class="kw">scales</span>::<span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">comma_format</a></span>(accuracy = <span class="fl">1</span>),
                     breaks = <span class="fl">2</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fl">19</span>, <span class="fl">1</span>))) <span class="op">+</span>
  <span class="fu">guides</span>(color = <span class="fl">FALSE</span>) <span class="op">+</span> 
  <span class="fu">labs</span>(title = <span class="st">"COVID-19 Cumulative Recorded Cases by US State"</span>,
       subtitle = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data as of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">covus</span><span class="op">$</span><span class="kw">date</span>), <span class="st">"%A, %B %e, %Y"</span>)),
       x = <span class="st">"Date"</span>, y = <span class="st">"Count of Cases (log 2 scale)"</span>, 
       caption = <span class="st">"Data: COVID Tracking Project, http://covidtracking.com | Graph: @kjhealy"</span>) <span class="op">+</span> 
  <span class="fu">theme_minimal</span>()
<span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span>

<span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span>
<span class="co">#&gt; Warning: Removed 15 row(s) containing missing values (geom_path).</span>
<span class="co">#&gt; Warning: Removed 7304 rows containing missing values (geom_text_repel).</span>
</pre></div>
<p><img src="us-data_files/figure-html/us-example-1.png" width="1200"></p>
</div>
<div id="calculating-daily-counts" class="section level3">
<h3 class="hasAnchor">
<a href="#calculating-daily-counts" class="anchor"></a>Calculating daily counts</h3>
<p>The COVID Tracking Project reports <em>cumulative</em> counts for key measures such as positive tests and deaths. For example, for New York State:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">

<span class="kw">measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"positive"</span>, <span class="st">"negative"</span>, <span class="st">"death"</span>)

<span class="kw">covus</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">measure</span> <span class="op">%in%</span> <span class="kw">measures</span>, <span class="kw">state</span> <span class="op">==</span> <span class="st">"NY"</span>) <span class="op">%&gt;%</span>
  <span class="fu">select</span>(<span class="kw">date</span>, <span class="kw">state</span>, <span class="kw">measure</span>, <span class="kw">count</span>) <span class="op">%&gt;%</span>
  <span class="fu">pivot_wider</span>(names_from = <span class="kw">measure</span>, values_from = <span class="kw">count</span>)
<span class="co">#&gt; # A tibble: 138 x 5</span>
<span class="co">#&gt;    date       state positive negative death</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2020-07-19 NY      406807  4708663 25048</span>
<span class="co">#&gt;  2 2020-07-18 NY      406305  4662961 25035</span>
<span class="co">#&gt;  3 2020-07-17 NY      405551  4593898 25024</span>
<span class="co">#&gt;  4 2020-07-16 NY      404775  4516435 25014</span>
<span class="co">#&gt;  5 2020-07-15 NY      404006  4444519 25003</span>
<span class="co">#&gt;  6 2020-07-14 NY      403175  4381752 24994</span>
<span class="co">#&gt;  7 2020-07-13 NY      402263  4322619 24989</span>
<span class="co">#&gt;  8 2020-07-12 NY      401706  4271489 24979</span>
<span class="co">#&gt;  9 2020-07-11 NY      401029  4209748 24974</span>
<span class="co">#&gt; 10 2020-07-10 NY      400299  4141275 24968</span>
<span class="co">#&gt; # … with 128 more rows</span>
</pre></div>
<p>To calculate <em>daily</em> counts from these cumulative measures, use <code><a href="https://rdrr.io/r/stats/lag.html">lag()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">

<span class="kw">covus</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">measure</span> <span class="op">%in%</span> <span class="kw">measures</span>, <span class="kw">state</span> <span class="op">==</span> <span class="st">"NY"</span>) <span class="op">%&gt;%</span>
  <span class="fu">select</span>(<span class="kw">date</span>, <span class="kw">state</span>, <span class="kw">measure</span>, <span class="kw">count</span>) <span class="op">%&gt;%</span>
  <span class="fu">pivot_wider</span>(names_from = <span class="kw">measure</span>, values_from = <span class="kw">count</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="kw">positive</span><span class="op">:</span><span class="kw">death</span>, <span class="op">~</span><span class="kw">.x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span>(<span class="kw">.x</span>, order_by = <span class="kw">date</span>), 
                .names = <span class="st">"daily_{col}"</span>))
<span class="co">#&gt; # A tibble: 138 x 8</span>
<span class="co">#&gt;    date       state positive negative death daily_positive daily_negative</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2020-07-19 NY      406807  4708663 25048            502          45702</span>
<span class="co">#&gt;  2 2020-07-18 NY      406305  4662961 25035            754          69063</span>
<span class="co">#&gt;  3 2020-07-17 NY      405551  4593898 25024            776          77463</span>
<span class="co">#&gt;  4 2020-07-16 NY      404775  4516435 25014            769          71916</span>
<span class="co">#&gt;  5 2020-07-15 NY      404006  4444519 25003            831          62767</span>
<span class="co">#&gt;  6 2020-07-14 NY      403175  4381752 24994            912          59133</span>
<span class="co">#&gt;  7 2020-07-13 NY      402263  4322619 24989            557          51130</span>
<span class="co">#&gt;  8 2020-07-12 NY      401706  4271489 24979            677          61741</span>
<span class="co">#&gt;  9 2020-07-11 NY      401029  4209748 24974            730          68473</span>
<span class="co">#&gt; 10 2020-07-10 NY      400299  4141275 24968            786          72772</span>
<span class="co">#&gt; # … with 128 more rows, and 1 more variable: daily_death &lt;dbl&gt;</span>
</pre></div>
</div>
<div id="draw-a-graph-of-the-weekly-rolling-average-death-rate-by-state" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-a-graph-of-the-weekly-rolling-average-death-rate-by-state" class="anchor"></a>Draw a graph of the weekly rolling average death rate, by state</h3>
<div class="sourceCode" id="cb6"><pre class="downlit">

<span class="kw">state_pops</span> <span class="op">&lt;-</span> <span class="kw">uspop</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">sex_id</span> <span class="op">==</span> <span class="st">"totsex"</span>, <span class="kw">hisp_id</span> <span class="op">==</span> <span class="st">"tothisp"</span>) <span class="op">%&gt;%</span>
  <span class="fu">select</span>(<span class="kw">state_abbr</span>, <span class="kw">statefips</span>, <span class="kw">pop</span>, <span class="kw">state</span>) <span class="op">%&gt;%</span>
  <span class="fu">rename</span>(name = <span class="kw">state</span>, 
         state = <span class="kw">state_abbr</span>, fips = <span class="kw">statefips</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(state = <span class="fu"><a href="https://rdrr.io/r/base/replace.html">replace</a></span>(<span class="kw">state</span>, <span class="kw">fips</span> <span class="op">==</span> <span class="st">"11"</span>, <span class="st">"DC"</span>))

<span class="co">## Using a convenience function to do something similar</span>
<span class="co">## to the lambda version above</span>
<span class="kw">get_daily_count</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">count</span>, <span class="kw">date</span>){
  <span class="kw">count</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span>(<span class="kw">count</span>, order_by = <span class="kw">date</span>)
}


<span class="kw">covus</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">measure</span> <span class="op">==</span> <span class="st">"death"</span>, <span class="kw">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw">state_pops</span><span class="op">$</span><span class="kw">state</span>)) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">state</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(
    deaths_daily = <span class="fu">get_daily_count</span>(<span class="kw">count</span>, <span class="kw">date</span>), 
    deaths7 = <span class="kw">slider</span>::<span class="fu"><a href="https://rdrr.io/pkg/slider/man/slide.html">slide_dbl</a></span>(<span class="kw">deaths_daily</span>, <span class="kw">mean</span>, .before = <span class="fl">7</span>, .after = <span class="fl">0</span>, na.rm = <span class="fl">TRUE</span>)) <span class="op">%&gt;%</span>
  <span class="fu">left_join</span>(<span class="kw">state_pops</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">date</span> <span class="op">&gt;</span> <span class="kw">lubridate</span>::<span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"2020-03-15"</span>)) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(mapping = <span class="fu">aes</span>(x = <span class="kw">date</span>, y = (<span class="kw">deaths7</span><span class="op">/</span><span class="kw">pop</span>)<span class="op">*</span><span class="fl">1e5</span>)) <span class="op">+</span> 
  <span class="fu">geom_line</span>(size = <span class="fl">0.5</span>) <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span>(labels = <span class="kw">scales</span>::<span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">comma_format</a></span>(accuracy = <span class="fl">1</span>)) <span class="op">+</span> 
  <span class="fu">facet_wrap</span>(<span class="op">~</span> <span class="kw">name</span>, ncol = <span class="fl">4</span>) <span class="op">+</span>
  <span class="fu">labs</span>(x = <span class="st">"Date"</span>, 
       y = <span class="st">"Deaths per 100,000 Population (Seven Day Rolling Average)"</span>, 
       title = <span class="st">"Average Death Rate from COVID-19: US States and Washington, DC"</span>, 
       subtitle = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"COVID Tracking Project data as of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">covnat</span><span class="op">$</span><span class="kw">date</span>), <span class="st">"%A, %B %e, %Y"</span>)), 
       caption = <span class="st">"Kieran Healy @kjhealy / Data: https://www.covidtracking.com/"</span>) <span class="op">+</span>
  <span class="fu">theme_minimal</span>()
<span class="co">#&gt; Joining, by = c("state", "fips")</span>
</pre></div>
<p><img src="us-data_files/figure-html/rolling-state-1.png" width="800"></p>
</div>
<div id="draw-a-graph-of-the-weekly-rolling-average-death-rate-by-state-with-free-y-axes-in-the-panels" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-a-graph-of-the-weekly-rolling-average-death-rate-by-state-with-free-y-axes-in-the-panels" class="anchor"></a>Draw a graph of the weekly rolling average death rate, by state, with free y-axes in the panels</h3>
<div class="sourceCode" id="cb7"><pre class="downlit">

<span class="kw">covus</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">measure</span> <span class="op">==</span> <span class="st">"death"</span>, <span class="kw">state</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw">state_pops</span><span class="op">$</span><span class="kw">state</span>)) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">state</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(
    deaths_daily = <span class="fu">get_daily_count</span>(<span class="kw">count</span>, <span class="kw">date</span>), 
    deaths7 = <span class="kw">slider</span>::<span class="fu"><a href="https://rdrr.io/pkg/slider/man/slide.html">slide_dbl</a></span>(<span class="kw">deaths_daily</span>, <span class="kw">mean</span>, .before = <span class="fl">7</span>, .after = <span class="fl">0</span>, na.rm = <span class="fl">TRUE</span>)) <span class="op">%&gt;%</span>
  <span class="fu">left_join</span>(<span class="kw">state_pops</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">date</span> <span class="op">&gt;</span> <span class="kw">lubridate</span>::<span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"2020-03-15"</span>)) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(mapping = <span class="fu">aes</span>(x = <span class="kw">date</span>, y = (<span class="kw">deaths7</span><span class="op">/</span><span class="kw">pop</span>)<span class="op">*</span><span class="fl">1e5</span>)) <span class="op">+</span> 
  <span class="fu">geom_line</span>(size = <span class="fl">0.5</span>) <span class="op">+</span> 
  <span class="fu">facet_wrap</span>(<span class="op">~</span> <span class="kw">name</span>, ncol = <span class="fl">4</span>, scales = <span class="st">"free_y"</span>) <span class="op">+</span>
  <span class="fu">labs</span>(x = <span class="st">"Date"</span>, 
       y = <span class="st">"Deaths per 100,000 Population (Seven Day Rolling Average)"</span>, 
       title = <span class="st">"Average Death Rate from COVID-19: US States and Washington, DC. Free scales."</span>, 
       subtitle = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"COVID Tracking Project data as of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">covnat</span><span class="op">$</span><span class="kw">date</span>), <span class="st">"%A, %B %e, %Y"</span>)), 
       caption = <span class="st">"Kieran Healy @kjhealy / Data: https://www.covidtracking.com/"</span>) <span class="op">+</span>
  <span class="fu">theme_minimal</span>()
<span class="co">#&gt; Joining, by = c("state", "fips")</span>
</pre></div>
<p><img src="us-data_files/figure-html/rolling-state-free-1.png" width="800"></p>
</div>
<div id="draw-a-graph-of-cumulative-reported-us-deaths-aggregated-to-the-national-level" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-a-graph-of-cumulative-reported-us-deaths-aggregated-to-the-national-level" class="anchor"></a>Draw a graph of cumulative reported US deaths, aggregated to the national level</h3>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">covus</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">measure</span> <span class="op">==</span> <span class="st">"death"</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">date</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarize</span>(count = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">count</span>, na.rm = <span class="fl">TRUE</span>)) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x = <span class="kw">date</span>, y = <span class="kw">count</span>)) <span class="op">+</span> 
  <span class="fu">geom_line</span>(size = <span class="fl">0.75</span>) <span class="op">+</span> 
  <span class="fu">scale_x_date</span>(date_breaks = <span class="st">"2 weeks"</span>, date_labels = <span class="st">"%b %e"</span> ) <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span>(labels = <span class="kw">scales</span>::<span class="kw"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>, breaks = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">160000</span>, <span class="fl">20000</span>)) <span class="op">+</span> 
  <span class="fu">labs</span>(title = <span class="st">"COVID-19 Cumulative Recorded Deaths in the United States"</span>,
       subtitle = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Data as of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">covus</span><span class="op">$</span><span class="kw">date</span>), <span class="st">"%A, %B %e, %Y"</span>), <span class="st">"Recorded counts underestimate total mortality."</span>),
       x = <span class="st">"Date"</span>, y = <span class="st">"Count of Deaths"</span>, 
       caption = <span class="st">"Data: COVID Tracking Project, http://covidtracking.com | Graph: @kjhealy"</span>) <span class="op">+</span> 
  <span class="fu">theme_minimal</span>()
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
</pre></div>
<p><img src="us-data_files/figure-html/us-example-2-1.png" width="1000"></p>
</div>
</div>
<div id="state-level-and-county-level-cumulative-data-from-the-new-york-times" class="section level2">
<h2 class="hasAnchor">
<a href="#state-level-and-county-level-cumulative-data-from-the-new-york-times" class="anchor"></a>State-Level and County-Level (Cumulative) Data from the <em>New York Times</em>
</h2>
<div id="state-level-table" class="section level3">
<h3 class="hasAnchor">
<a href="#state-level-table" class="anchor"></a>State-level table</h3>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">nytcovstate</span>
<span class="co">#&gt; # A tibble: 7,659 x 5</span>
<span class="co">#&gt;    date       state      fips  cases deaths</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2020-01-21 Washington 53        1      0</span>
<span class="co">#&gt;  2 2020-01-22 Washington 53        1      0</span>
<span class="co">#&gt;  3 2020-01-23 Washington 53        1      0</span>
<span class="co">#&gt;  4 2020-01-24 Illinois   17        1      0</span>
<span class="co">#&gt;  5 2020-01-24 Washington 53        1      0</span>
<span class="co">#&gt;  6 2020-01-25 California 06        1      0</span>
<span class="co">#&gt;  7 2020-01-25 Illinois   17        1      0</span>
<span class="co">#&gt;  8 2020-01-25 Washington 53        1      0</span>
<span class="co">#&gt;  9 2020-01-26 Arizona    04        1      0</span>
<span class="co">#&gt; 10 2020-01-26 California 06        2      0</span>
<span class="co">#&gt; # … with 7,649 more rows</span>
</pre></div>
</div>
<div id="county-level-table" class="section level3">
<h3 class="hasAnchor">
<a href="#county-level-table" class="anchor"></a>County-level table</h3>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">nytcovcounty</span>
<span class="co">#&gt; # A tibble: 350,365 x 6</span>
<span class="co">#&gt;    date       county      state      fips  cases deaths</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2020-01-21 Snohomish   Washington 53061     1      0</span>
<span class="co">#&gt;  2 2020-01-22 Snohomish   Washington 53061     1      0</span>
<span class="co">#&gt;  3 2020-01-23 Snohomish   Washington 53061     1      0</span>
<span class="co">#&gt;  4 2020-01-24 Cook        Illinois   17031     1      0</span>
<span class="co">#&gt;  5 2020-01-24 Snohomish   Washington 53061     1      0</span>
<span class="co">#&gt;  6 2020-01-25 Orange      California 06059     1      0</span>
<span class="co">#&gt;  7 2020-01-25 Cook        Illinois   17031     1      0</span>
<span class="co">#&gt;  8 2020-01-25 Snohomish   Washington 53061     1      0</span>
<span class="co">#&gt;  9 2020-01-26 Maricopa    Arizona    04013     1      0</span>
<span class="co">#&gt; 10 2020-01-26 Los Angeles California 06037     1      0</span>
<span class="co">#&gt; # … with 350,355 more rows</span>
</pre></div>
</div>
<div id="draw-a-log-linear-graph-of-cumulative-us-cases-by-county-" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-a-log-linear-graph-of-cumulative-us-cases-by-county-" class="anchor"></a>Draw a log-linear graph of cumulative US cases by county.</h3>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">nytcovcounty</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(uniq_name = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw">county</span>, <span class="kw">state</span>)) <span class="op">%&gt;%</span> <span class="co"># Can't use FIPS because of how the NYT bundled cities</span>
  <span class="fu">group_by</span>(<span class="kw">uniq_name</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(days_elapsed = <span class="kw">date</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw">date</span>)) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x = <span class="kw">days_elapsed</span>, y = <span class="kw">cases</span>, group = <span class="kw">uniq_name</span>)) <span class="op">+</span> 
  <span class="fu">geom_line</span>(size = <span class="fl">0.25</span>, color = <span class="st">"gray20"</span>) <span class="op">+</span> 
  <span class="fu">scale_y_log10</span>(labels = <span class="kw">scales</span>::<span class="fu"><a href="https://scales.r-lib.org//reference/label_number_si.html">label_number_si</a></span>()) <span class="op">+</span> 
  <span class="fu">guides</span>(color = <span class="fl">FALSE</span>) <span class="op">+</span> 
  <span class="fu">facet_wrap</span>(<span class="op">~</span> <span class="kw">state</span>, ncol = <span class="fl">5</span>) <span class="op">+</span> 
  <span class="fu">labs</span>(title = <span class="st">"COVID-19 Cumulative Recorded Cases by US County"</span>,
       subtitle = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"New York is bundled into a single area in this data.\nData as of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">nytcovcounty</span><span class="op">$</span><span class="kw">date</span>), <span class="st">"%A, %B %e, %Y"</span>)),
       x = <span class="st">"Days since first case"</span>, y = <span class="st">"Count of Cases (log 10 scale)"</span>, 
       caption = <span class="st">"Data: The New York Times | Graph: @kjhealy"</span>) <span class="op">+</span> 
  <span class="fu">theme_minimal</span>()
<span class="co">#&gt; Don't know how to automatically pick scale for object of type difftime. Defaulting to continuous.</span>
<span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span>
</pre></div>
<p><img src="us-data_files/figure-html/nytplot-1.png" width="1200"></p>
</div>
</div>
<div id="us-cdc-surveillance-network-data" class="section level2">
<h2 class="hasAnchor">
<a href="#us-cdc-surveillance-network-data" class="anchor"></a>US CDC Surveillance Network Data</h2>
<p>This US Centers for Disase Control surveillance network conducts population-based surveillance for laboratory-confirmed COVID-19-associated hospitalizations in children (persons younger than 18 years) and adults in the United States. The current network covers nearly 100 counties in the 10 Emerging Infections Program (EIP) states (CA, CO, CT, GA, MD, MN, NM, NY, OR, and TN) and four additional states through the Influenza Hospitalization Surveillance Project (IA, MI, OH, and UT). The network represents approximately 10% of US population (~32 million people). Cases are identified by reviewing hospital, laboratory, and admission databases and infection control logs for patients hospitalized with a documented positive SARS-CoV-2 test. Data gathered are used to estimate age-specific hospitalization rates on a weekly basis and describe characteristics of persons hospitalized with COVID-19. Laboratory confirmation is dependent on clinician-ordered SARS-CoV-2 testing. Therefore, the unadjusted rates provided are likely to be underestimated as COVID-19-associated hospitalizations can be missed due to test availability and provider or facility testing practices. COVID-NET hospitalization data are preliminary and subject to change as more data become available. All incidence rates are unadjusted. Please use the following citation when referencing these data: “COVID-NET: COVID-19-Associated Hospitalization Surveillance Network, Centers for Disease Control and Prevention. WEBSITE. Accessed on DATE”.</p>
<p>Thanks to Bob Rudis’s <a href="https://github.com/hrbrmstr/cdccovidview"><code>cdccovidview</code></a> package for making these data tractable to include.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">cdc_hospitalizations</span>
<span class="co">#&gt; # A tibble: 4,590 x 8</span>
<span class="co">#&gt;    catchment network year  mmwr_year mmwr_week age_category cumulative_rate</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Entire N… COVID-… 2020  2020      10        0-4 yr                   0  </span>
<span class="co">#&gt;  2 Entire N… COVID-… 2020  2020      11        0-4 yr                   0  </span>
<span class="co">#&gt;  3 Entire N… COVID-… 2020  2020      12        0-4 yr                   0  </span>
<span class="co">#&gt;  4 Entire N… COVID-… 2020  2020      13        0-4 yr                   0.4</span>
<span class="co">#&gt;  5 Entire N… COVID-… 2020  2020      14        0-4 yr                   0.9</span>
<span class="co">#&gt;  6 Entire N… COVID-… 2020  2020      15        0-4 yr                   1.4</span>
<span class="co">#&gt;  7 Entire N… COVID-… 2020  2020      16        0-4 yr                   2.1</span>
<span class="co">#&gt;  8 Entire N… COVID-… 2020  2020      17        0-4 yr                   2.5</span>
<span class="co">#&gt;  9 Entire N… COVID-… 2020  2020      18        0-4 yr                   3.1</span>
<span class="co">#&gt; 10 Entire N… COVID-… 2020  2020      19        0-4 yr                   3.6</span>
<span class="co">#&gt; # … with 4,580 more rows, and 1 more variable: weekly_rate &lt;dbl&gt;</span>

<span class="kw">cdc_catchments</span>
<span class="co">#&gt; # A tibble: 17 x 2</span>
<span class="co">#&gt;    name      area          </span>
<span class="co">#&gt;  * &lt;chr&gt;     &lt;chr&gt;         </span>
<span class="co">#&gt;  1 COVID-NET Entire Network</span>
<span class="co">#&gt;  2 EIP       California    </span>
<span class="co">#&gt;  3 EIP       Colorado      </span>
<span class="co">#&gt;  4 EIP       Connecticut   </span>
<span class="co">#&gt;  5 EIP       Entire Network</span>
<span class="co">#&gt;  6 EIP       Georgia       </span>
<span class="co">#&gt;  7 EIP       Maryland      </span>
<span class="co">#&gt;  8 EIP       Minnesota     </span>
<span class="co">#&gt;  9 EIP       New Mexico    </span>
<span class="co">#&gt; 10 EIP       New York      </span>
<span class="co">#&gt; 11 EIP       Oregon        </span>
<span class="co">#&gt; 12 EIP       Tennessee     </span>
<span class="co">#&gt; 13 IHSP      Entire Network</span>
<span class="co">#&gt; 14 IHSP      Iowa          </span>
<span class="co">#&gt; 15 IHSP      Michigan      </span>
<span class="co">#&gt; 16 IHSP      Ohio          </span>
<span class="co">#&gt; 17 IHSP      Utah</span>

<span class="kw">cdc_deaths_by_state</span>
<span class="co">#&gt; # A tibble: 53 x 10</span>
<span class="co">#&gt;    data_as_of state start_week end_week   covid_deaths total_deaths</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;chr&gt; &lt;date&gt;     &lt;date&gt;            &lt;int&gt;        &lt;int&gt;</span>
<span class="co">#&gt;  1 2020-04-30 Alab… 2020-02-01 2020-04-25          153        12427</span>
<span class="co">#&gt;  2 2020-04-30 Alas… 2020-02-01 2020-04-25           NA          856</span>
<span class="co">#&gt;  3 2020-04-30 Ariz… 2020-02-01 2020-04-25          194        15859</span>
<span class="co">#&gt;  4 2020-04-30 Arka… 2020-02-01 2020-04-25           26         7774</span>
<span class="co">#&gt;  5 2020-04-30 Cali… 2020-02-01 2020-04-25         1111        69341</span>
<span class="co">#&gt;  6 2020-04-30 Colo… 2020-02-01 2020-04-25          511        10721</span>
<span class="co">#&gt;  7 2020-04-30 Conn… 2020-02-01 2020-04-25           16         1277</span>
<span class="co">#&gt;  8 2020-04-30 Dela… 2020-02-01 2020-04-25           53         2034</span>
<span class="co">#&gt;  9 2020-04-30 Dist… 2020-02-01 2020-04-25           58         1452</span>
<span class="co">#&gt; 10 2020-04-30 Flor… 2020-02-01 2020-04-25          784        54148</span>
<span class="co">#&gt; # … with 43 more rows, and 4 more variables: percent_expected_deaths &lt;dbl&gt;,</span>
<span class="co">#&gt; #   pneumonia_deaths &lt;int&gt;, pneumonia_and_covid_deaths &lt;int&gt;,</span>
<span class="co">#&gt; #   all_influenza_deaths_j09_j11 &lt;int&gt;</span>

<span class="kw">nssp_covid_er_reg</span>
<span class="co">#&gt; # A tibble: 538 x 9</span>
<span class="co">#&gt;     week num_fac total_ed_visits visits pct_visits visit_type region source</span>
<span class="co">#&gt;    &lt;int&gt;   &lt;int&gt; &lt;chr&gt;            &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; </span>
<span class="co">#&gt;  1    41     202 130377             814    0.006   ili        Regio… Emerg…</span>
<span class="co">#&gt;  2    42     202 132385             912    0.00700 ili        Regio… Emerg…</span>
<span class="co">#&gt;  3    43     202 131866             883    0.00700 ili        Regio… Emerg…</span>
<span class="co">#&gt;  4    44     203 128256             888    0.00700 ili        Regio… Emerg…</span>
<span class="co">#&gt;  5    45     203 127466             979    0.008   ili        Regio… Emerg…</span>
<span class="co">#&gt;  6    46     202 125306            1188    0.009   ili        Regio… Emerg…</span>
<span class="co">#&gt;  7    47     202 128877            1235    0.01    ili        Regio… Emerg…</span>
<span class="co">#&gt;  8    48     202 124781            1451    0.012   ili        Regio… Emerg…</span>
<span class="co">#&gt;  9    49     202 125939            1362    0.011   ili        Regio… Emerg…</span>
<span class="co">#&gt; 10    50     202 130430            1405    0.011   ili        Regio… Emerg…</span>
<span class="co">#&gt; # … with 528 more rows, and 1 more variable: year &lt;int&gt;</span>
</pre></div>
<div id="summary-view-of-cdc-surveillance-network-data" class="section level3">
<h3 class="hasAnchor">
<a href="#summary-view-of-cdc-surveillance-network-data" class="anchor"></a>Summary view of CDC Surveillance Network Data</h3>
<div class="sourceCode" id="cb13"><pre class="downlit">

<span class="kw">age_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="st">"0-4 yr"</span>, <span class="st">"5-17 yr"</span>, <span class="st">"18-49 yr"</span>, 
  <span class="st">"50-64 yr"</span>, <span class="st">"65+ yr"</span>, <span class="st">"65-74 yr"</span>, 
  <span class="st">"75-84 yr"</span>, <span class="st">"85+"</span>)

<span class="kw">cdc_hospitalizations</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(start = <span class="fu"><a href="../reference/mmwr_week_to_date.html">mmwr_week_to_date</a></span>(<span class="kw">mmwr_year</span>, <span class="kw">mmwr_week</span>)) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">weekly_rate</span>)) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">catchment</span> <span class="op">==</span> <span class="st">"Entire Network"</span>) <span class="op">%&gt;%</span> 
  <span class="fu">select</span>(<span class="kw">start</span>, <span class="kw">network</span>, <span class="kw">age_category</span>, <span class="kw">weekly_rate</span>) <span class="op">%&gt;%</span>  
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">age_category</span> != <span class="st">"Overall"</span>) <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span>(age_category = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">age_category</span>, levels = <span class="kw">age_f</span>)) <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span>() <span class="op">+</span>
  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="kw">start</span>, <span class="kw">weekly_rate</span>)) <span class="op">+</span>
  <span class="fu">scale_x_date</span>(
    date_breaks = <span class="st">"8 weeks"</span>, date_labels = <span class="st">"%b\n%d"</span>
  ) <span class="op">+</span>
  <span class="fu">facet_grid</span>(<span class="kw">network</span> <span class="op">~</span> <span class="kw">age_category</span>) <span class="op">+</span>
  <span class="fu">labs</span>(x = <span class="kw">NULL</span>, y = <span class="st">"Rates per 100,000 pop"</span>,
    title = <span class="st">"COVID-NET Weekly Rates by Network and Age Group"</span>,
    subtitle = <span class="st">"Courtesy Bob Rudis's cdccovidview"</span>,
    caption = <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"Source: COVID-NET: COVID-19-Associated Hospitalization Surveillance Network, Centers for Disease Control and Prevention.\n&lt;https://gis.cdc.gov/grasp/COVIDNet/COVID19_3.html&gt;; Accessed on %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>())) <span class="op">+</span>
  <span class="fu">theme_minimal</span>()
</pre></div>
<p><img src="us-data_files/figure-html/cdc-example-1.png" width="1800"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://kieranhealy.org">Kieran Healy</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
